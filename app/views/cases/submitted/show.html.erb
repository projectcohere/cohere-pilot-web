<main class="Main">
  <%- view = Cases::View.new(@case) %>
  <h1 class="Main-title">
    <%= view.recipient_name %>'s case
  </h1>

  <div class ="ShowCase">
    <article class="ShowCase-case Detail">
      <section class="ShowCase-contact Detail-section">
        <h1><span>Contact</span></h1>
        <label class="ShowCase-phoneNumber DetailField">
          <span class="DetailField-hint">
            Phone #
          </span>
          <p class="DetailField-text">
            <%= view.phone_number %>
          </p>
        </label>
        <label class="ShowCase-address DetailField">
          <span class="DetailField-hint">
            Primary Residential Address
          </span>
          <p class="DetailField-text">
            <% view.address.each do |line| %>
              <%= line %>
              <br>
            <% end %>
          </p>
        </section>
      </section>

      <section class="ShowCase-utilityAccount Detail-section">
        <h1><span>Utility Account</span></h1>
        <label class="ShowCase-supplier DetailField">
          <span class="DetailField-hint">
            Supplier
          </span>
          <p class="DetailField-text">
            <%= view.supplier_name %>
          </p>
        </label>
        <label class="ShowCase-accountNumber DetailField">
          <span class="DetailField-hint">
            Account #
          </span>
          <p class="DetailField-text">
            <%= view.account_number %>
          </p>
        </label>
        <label class="ShowCase-arrears DetailField">
          <span class="DetailField-hint">
            Arrears
          </span>
          <p class="DetailField-text">
            <%= view.account_arrears %>
          </p>
        </label>
      </section>

      <section class="ShowCase-dhs Detail-section">
        <h1><span>MDHHS</span></h1>
        <label class="ShowCase-dhsNumber DetailField">
          <span class="DetailField-hint">
            Case #
          </span>
          <p class="DetailField-text">
            <%= view.dhs_number %>
          </p>
        </label>
      </section>

      <section class="ShowCase-household Detail-section">
        <h1><span>Household</span></h1>
        <label class="ShowCase-householdSize DetailField">
          <span class="DetailField-hint">
            Size
          </span>
          <p class="DetailField-text">
            <%= view.household_size %>
          </p>
        </label>
        <label class="ShowCase-monthlyIncome DetailField">
          <span class="DetailField-hint">
            Monthly Income
          </span>
          <p class="DetailField-text">
            <%= view.household_income %>
          </p>
        </label>
      </section>
    </article>
    <section class="CaseDocuments">
      <h1>Documents</h1>
      <ul class="CaseDocuments-list">
        <% if view.documents.blank? %>
          <p>This case has no documents yet.</p>
        <% else %>
          <% view.documents.each do |d| %>
            <li class="CaseDocument">
              <%- file_url = d.file.attached? ? url_for(d.file) : nil %>
              <% if file_url.nil? %>
                <p class="CaseDocument-placeholder">This file is being processed.</p>
              <% else %>
                <%= image_tag(file_url, height: 140, class: "CaseDocument-image") %>
              <% end %>
              <%= link_to("View Document", file_url || "", target: "_blank", rel: "noopener noreferrer") %>
            </li>
          <% end %>
        <% end %>
      </ul>
    </section>
  </div>
</main>
