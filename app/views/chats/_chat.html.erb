<article class="<%= cx(local_assigns[:class], "Chat") %>">
  <%- data = { sender: sender, receiver: receiver } %>
  <%- data.merge!(local_assigns[:data] || {}) %>

  <div class="Chat-window">
    <%= tag.ol(id: "chat", class: "Chat-messages", data: data) do %>
      <%- chat.messages.each do |msg| %>
        <% is_sent = msg.sent_by?(sender) %>
        <li class="<%= cx("ChatMessage", "ChatMessage--sent" => is_sent, "ChatMessage--received" => !is_sent) %>">
          <label class="ChatMessage-sender">
            <%= is_sent ? "Me" : receiver %>
          </label>
          <p class="ChatMessage-body">
            <%= msg.body %>
          </p>
        </li>
      <%- end %>
    <%- end %>

    <%= form_for(:chat, html: { id: "chat-form", class: "Chat-form" }) do |f| %>
      <ol id="chat-files" class="Chat-files is-empty"></ol>

      <div class="Chat-controls">
        <div class="Chat-field">
          <span id="chat-input" contenteditable="true" class="Chat-input"></span>
          <span class="Chat-placeholder">Enter your message...</span>
        </div>

        <label class="Chat-addFile">
          <input id="chat-file-input" type="file" multiple="true" />
        </label>
        <button class="Chat-send" alt="Send Message"></button>
      </div>
    <% end %>
  </div>
</article>
